<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="CStyle.css">
<body>
<pre><code class="comment">/*        Generated by TAPENADE     (INRIA, Tropics team)</code>
<code class="comment">    Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code>
<code class="comment">*/</code>
<a name="qr"></a><code class="include">#include "GlobalDeclarations.c"</code>
<a name="qri0"></a>
<a name="qri1"></a><a href="qr_b.html#qr_b" target="diffFile"><code class="typename">void </code>qr(<code class="modifier">double </code><code class="keyword">*</code>a, <code class="modifier">double </code><code class="keyword">*</code>qt, <code class="modifier">double </code><code class="keyword">*</code>r, <code class="typename">int </code>na) {</a>
<a name="qri2"></a>    <a href="qr_b.html#qr_b" target="diffFile"><code class="modifier">double </code>at, bt, rt, ct, st, rnk, qtnk;</a>
    <a href="qr_b.html#qr_b" target="diffFile"><code class="typename">int </code>n, m, k, tmp;</a>
<a name="qri3"></a>    <a href="qr_b.html#qr_b" target="diffFile"><code class="comment">/* prepare Q and r */</code></a>
<a name="qri4"></a>    <a href="qr_b.html#qr_b" target="diffFile"><code class="keyword">for </code>(n = <code class="constant">0</code>; n != na; ++n)</a>
<a name="qri5"></a>        <a href="qr_b.html#qr_b" target="diffFile"><code class="keyword">for </code>(m = <code class="constant">0</code>; m != na; ++m) {</a>
            <a href="qr_b.html#qr_b" target="diffFile"><code class="keyword">if </code>(n == m)</a>
<a name="qri6"></a>                <a href="qr_b.html#qr_b" target="diffFile">tmp = <code class="constant">1</code>;</a>
<a name="qri7"></a>            <a href="qr_b.html#qr_b" target="diffFile"><code class="keyword">else</code></a>
                <a href="qr_b.html#qr_b" target="diffFile">tmp = <code class="constant">0</code>;</a>
<a name="qri8"></a>            <a href="qr_b.html#qr_bi0" target="diffFile">qt<code class="keyword">[</code>myindex(n, m, na)<code class="keyword">]</code> = tmp;</a>
<a name="qri9"></a>        <a href="qr_b.html#qr_b" target="diffFile">}</a>
<a name="qri10"></a>    <a href="qr_b.html#qr_b" target="diffFile"><code class="keyword">for </code>(n = <code class="constant">0</code>; n != na; ++n)</a>
<a name="qri11"></a>        <a href="qr_b.html#qr_b" target="diffFile"><code class="keyword">for </code>(m = <code class="constant">0</code>; m != na; ++m)</a>
            <a href="qr_b.html#qr_bi1" target="diffFile">r<code class="keyword">[</code>myindex(n, m, na)<code class="keyword">]</code> = a<code class="keyword">[</code>myindex(n, m, na)<code class="keyword">]</code>;</a>
<a name="qri12"></a>    <a href="qr_b.html#qr_b" target="diffFile"><code class="comment">/* MAIN ALGORITHM */</code></a>
<a name="qri13"></a>    <a href="qr_b.html#qr_b" target="diffFile"><code class="keyword">for </code>(n = <code class="constant">0</code>; n != na; ++n)</a>
        <a href="qr_b.html#qr_b" target="diffFile"><code class="keyword">for </code>(m = n + <code class="constant">1</code>; m != na; ++m) {</a>
<a name="qri14"></a>            <a href="qr_b.html#qr_bi6" target="diffFile"><code class="comment">/* defining coefficients of the Givens rotation */</code></a>
<a name="qri15"></a>            <a href="qr_b.html#qr_bi6" target="diffFile">at = r<code class="keyword">[</code>myindex(n, n, na)<code class="keyword">]</code>;</a>
<a name="qri16"></a>            <a href="qr_b.html#qr_bi5" target="diffFile">bt = r<code class="keyword">[</code>myindex(m, n, na)<code class="keyword">]</code>;</a>
<a name="qri17"></a>            <a href="qr_b.html#qr_bi3" target="diffFile">rt = sqrt(at*at + bt*bt);</a>
<a name="qri18"></a>            <a href="qr_b.html#qr_bi4" target="diffFile">ct = at/rt;</a>
<a name="qri19"></a>            <a href="qr_b.html#qr_bi2" target="diffFile">st = bt/rt;</a>
            <a href="qr_b.html#qr_b" target="diffFile"><code class="keyword">for </code>(k = <code class="constant">0</code>; k != na; ++k) {</a>
<a name="qri20"></a>                <a href="qr_b.html#qr_bi12" target="diffFile"><code class="comment">/* update r */</code></a>
<a name="qri21"></a>                <a href="qr_b.html#qr_bi12" target="diffFile">rnk = r<code class="keyword">[</code>myindex(n, k, na)<code class="keyword">]</code>;</a>
<a name="qri22"></a>                <a href="qr_b.html#qr_bi11" target="diffFile">r<code class="keyword">[</code>myindex(n, k, na)<code class="keyword">]</code> = ct*rnk + st*r<code class="keyword">[</code>myindex(m, k, na)<code class="keyword">]</code>;</a>
                <a href="qr_b.html#qr_bi10" target="diffFile">r<code class="keyword">[</code>myindex(m, k, na)<code class="keyword">]</code> = -st*rnk + ct*r<code class="keyword">[</code>myindex(m, k, na)<code class="keyword">]</code>;</a>
<a name="qri23"></a>                <a href="qr_b.html#qr_bi9" target="diffFile"><code class="comment">/* update Q */</code></a>
<a name="qri24"></a>                <a href="qr_b.html#qr_bi9" target="diffFile">qtnk = qt<code class="keyword">[</code>myindex(n, k, na)<code class="keyword">]</code>;</a>
                <a href="qr_b.html#qr_bi8" target="diffFile">qt<code class="keyword">[</code>myindex(n, k, na)<code class="keyword">]</code> = ct*qtnk + st*qt<code class="keyword">[</code>myindex(m, k, na)<code class="keyword">]</code>;</a>
                <a href="qr_b.html#qr_bi7" target="diffFile">qt<code class="keyword">[</code>myindex(m, k, na)<code class="keyword">]</code> = -st*qtnk + ct*qt<code class="keyword">[</code>myindex(m, k, na)<code class="keyword">]</code>;</a>
            <a href="qr_b.html#qr_b" target="diffFile">}</a>
        <a href="qr_b.html#qr_b" target="diffFile">}</a>
<a href="qr_b.html#qr_b" target="diffFile">}</a>
</pre>
</body>
