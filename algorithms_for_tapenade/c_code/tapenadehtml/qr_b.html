<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="CStyle.css">
<body>
<pre><code class="comment">/*        Generated by TAPENADE     (INRIA, Tropics team)</code>
<code class="comment">    Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code>
<code class="comment">*/</code>
<a name="qr_b"></a><code class="include">#include "GlobalDeclarations_b.c"</code>

<a href="qr_p.html#qr" target="origFile"><code class="comment">/*</code></a>
<a href="qr_p.html#qr" target="origFile"><code class="comment">  Differentiation of qr in reverse (adjoint) mode:</code></a>
<a href="qr_p.html#qr" target="origFile"><code class="comment">   gradient     of useful results: *r *qt</code></a>
<a href="qr_p.html#qr" target="origFile"><code class="comment">   with respect to varying inputs: *r *qt *a</code></a>
<a href="qr_p.html#qr" target="origFile"><code class="comment">*/</code></a>
<a href="qr_p.html#qr" target="origFile"><code class="typename">void </code>qr_b(<code class="modifier">double </code><code class="keyword">*</code>a, <code class="modifier">double </code><code class="keyword">*</code>ab, <code class="modifier">double </code><code class="keyword">*</code>qt, <code class="modifier">double </code><code class="keyword">*</code>qtb, <code class="modifier">double </code><code class="keyword">*</code>r, <code class="modifier">double </code><code class="keyword">*</code></a>
<a href="qr_p.html#qr" target="origFile"><code class="label">        </code>rb, <code class="typename">int </code>na) {</a>
    <a href="qr_p.html#qri0" target="origFile"><code class="modifier">double </code>at, bt, rt, ct, st, rnk, qtnk;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="modifier">double </code>atb, btb, rtb, ctb, stb, rnkb, qtnkb;</a>
    <a href="qr_p.html#qri1" target="origFile"><code class="typename">int </code>n, m, k, tmp;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res0;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res1;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res2;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res3;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res4;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res5;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res6;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="modifier">double </code>tmp0;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res7;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res8;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="modifier">double </code>tmp1;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res9;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res10;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res11;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="modifier">double </code>tmp2;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res12;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>res13;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="modifier">double </code>tmp3;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="typename">int </code>adFrom;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="modifier">double </code>tmp0b;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="modifier">double </code>tmp3b;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="modifier">double </code>tempb;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="modifier">double </code>tmp2b;</a>
    <a href="qr_p.html#qr" target="origFile"><code class="modifier">double </code>tmp1b;</a>
    <a href="qr_p.html#qri2" target="origFile"><code class="comment">/* prepare Q and r */</code></a>
    <a href="qr_p.html#qri2" target="origFile"><code class="keyword">for </code>(n = <code class="constant">0</code>; n <= na-<code class="constant">1</code>; ++n)</a>
        <a href="qr_p.html#qri3" target="origFile"><code class="keyword">for </code>(m = <code class="constant">0</code>; m <= na-<code class="constant">1</code>; ++m) {</a>
            <a href="qr_p.html#qri4" target="origFile"><code class="keyword">if </code>(n == m)</a>
                <a href="qr_p.html#qri5" target="origFile">tmp = <code class="constant">1</code>;</a>
            <a href="qr_p.html#qri4" target="origFile"><code class="keyword">else</code></a>
                <a href="qr_p.html#qri6" target="origFile">tmp = <code class="constant">0</code>;</a>
            <a href="qr_p.html#qri7" target="origFile">res = myindex(n, m, na);</a>
            <a href="qr_p.html#qri7" target="origFile">qt<code class="keyword">[</code>res<code class="keyword">]</code> = tmp;</a>
        <a href="qr_p.html#qri3" target="origFile">}</a>
    <a href="qr_p.html#qri8" target="origFile"><code class="keyword">for </code>(n = <code class="constant">0</code>; n <= na-<code class="constant">1</code>; ++n)</a>
        <a href="qr_p.html#qri9" target="origFile"><code class="keyword">for </code>(m = <code class="constant">0</code>; m <= na-<code class="constant">1</code>; ++m) {</a>
            <a href="qr_p.html#qri10" target="origFile">res0 = myindex(n, m, na);</a>
            <a href="qr_p.html#qri10" target="origFile">res1 = myindex(n, m, na);</a>
            <a href="qr_p.html#qri10" target="origFile">r<code class="keyword">[</code>res0<code class="keyword">]</code> = a<code class="keyword">[</code>res1<code class="keyword">]</code>;</a>
        <a href="qr_p.html#qri9" target="origFile">}</a>
    <a href="qr_p.html#qri11" target="origFile"><code class="comment">/* MAIN ALGORITHM */</code></a>
    <a href="qr_p.html#qri11" target="origFile"><code class="keyword">for </code>(n = <code class="constant">0</code>; n <= na-<code class="constant">1</code>; ++n) {</a>
        <a href="qr_p.html#qri11" target="origFile">adFrom = n + <code class="constant">1</code>;</a>
        <a href="qr_p.html#qri12" target="origFile"><code class="keyword">for </code>(m = adFrom; m <= na-<code class="constant">1</code>; ++m) {</a>
            <a href="qr_p.html#qri13" target="origFile"><code class="comment">/* defining coefficients of the Givens rotation */</code></a>
            <a href="qr_p.html#qri13" target="origFile">res2 = myindex(n, n, na);</a>
            <a href="qr_p.html#qri13" target="origFile">pushreal8_(at);</a>
            <a href="qr_p.html#qri13" target="origFile">at = r<code class="keyword">[</code>res2<code class="keyword">]</code>;</a>
            <a href="qr_p.html#qri14" target="origFile">res3 = myindex(m, n, na);</a>
            <a href="qr_p.html#qri14" target="origFile">pushreal8_(bt);</a>
            <a href="qr_p.html#qri14" target="origFile">bt = r<code class="keyword">[</code>res3<code class="keyword">]</code>;</a>
            <a href="qr_p.html#qri15" target="origFile">pushreal8_(rt);</a>
            <a href="qr_p.html#qri15" target="origFile">rt = sqrt(at*at + bt*bt);</a>
            <a href="qr_p.html#qri16" target="origFile">pushreal8_(ct);</a>
            <a href="qr_p.html#qri16" target="origFile">ct = at/rt;</a>
            <a href="qr_p.html#qri17" target="origFile">pushreal8_(st);</a>
            <a href="qr_p.html#qri17" target="origFile">st = bt/rt;</a>
            <a href="qr_p.html#qri18" target="origFile"><code class="keyword">for </code>(k = <code class="constant">0</code>; k <= na-<code class="constant">1</code>; ++k) {</a>
                <a href="qr_p.html#qri19" target="origFile"><code class="comment">/* update r */</code></a>
                <a href="qr_p.html#qri19" target="origFile">res4 = myindex(n, k, na);</a>
                <a href="qr_p.html#qri19" target="origFile">pushreal8_(rnk);</a>
                <a href="qr_p.html#qri19" target="origFile">rnk = r<code class="keyword">[</code>res4<code class="keyword">]</code>;</a>
                <a href="qr_p.html#qri20" target="origFile">res5 = myindex(n, k, na);</a>
                <a href="qr_p.html#qri20" target="origFile">res6 = myindex(m, k, na);</a>
                <a href="qr_p.html#qri20" target="origFile">tmp0 = ct*rnk + st*r<code class="keyword">[</code>res6<code class="keyword">]</code>;</a>
                <a href="qr_p.html#qri20" target="origFile">pushreal8_(r<code class="keyword">[</code>res5<code class="keyword">]</code>);</a>
                <a href="qr_p.html#qri20" target="origFile">r<code class="keyword">[</code>res5<code class="keyword">]</code> = tmp0;</a>
                <a href="qr_p.html#qri21" target="origFile">res7 = myindex(m, k, na);</a>
                <a href="qr_p.html#qri21" target="origFile">res8 = myindex(m, k, na);</a>
                <a href="qr_p.html#qri21" target="origFile">tmp1 = -st*rnk + ct*r<code class="keyword">[</code>res8<code class="keyword">]</code>;</a>
                <a href="qr_p.html#qri21" target="origFile">pushreal8_(r<code class="keyword">[</code>res7<code class="keyword">]</code>);</a>
                <a href="qr_p.html#qri21" target="origFile">r<code class="keyword">[</code>res7<code class="keyword">]</code> = tmp1;</a>
                <a href="qr_p.html#qri22" target="origFile"><code class="comment">/* update Q */</code></a>
                <a href="qr_p.html#qri22" target="origFile">res9 = myindex(n, k, na);</a>
                <a href="qr_p.html#qri22" target="origFile">pushreal8_(qtnk);</a>
                <a href="qr_p.html#qri22" target="origFile">qtnk = qt<code class="keyword">[</code>res9<code class="keyword">]</code>;</a>
                <a href="qr_p.html#qri23" target="origFile">res10 = myindex(n, k, na);</a>
                <a href="qr_p.html#qri23" target="origFile">res11 = myindex(m, k, na);</a>
                <a href="qr_p.html#qri23" target="origFile">tmp2 = ct*qtnk + st*qt<code class="keyword">[</code>res11<code class="keyword">]</code>;</a>
                <a href="qr_p.html#qri23" target="origFile">pushreal8_(qt<code class="keyword">[</code>res10<code class="keyword">]</code>);</a>
                <a href="qr_p.html#qri23" target="origFile">qt<code class="keyword">[</code>res10<code class="keyword">]</code> = tmp2;</a>
                <a href="qr_p.html#qri24" target="origFile">res12 = myindex(m, k, na);</a>
                <a href="qr_p.html#qri24" target="origFile">res13 = myindex(m, k, na);</a>
                <a href="qr_p.html#qri24" target="origFile">tmp3 = -st*qtnk + ct*qt<code class="keyword">[</code>res13<code class="keyword">]</code>;</a>
                <a href="qr_p.html#qri24" target="origFile">pushreal8_(qt<code class="keyword">[</code>res12<code class="keyword">]</code>);</a>
                <a href="qr_p.html#qri24" target="origFile">qt<code class="keyword">[</code>res12<code class="keyword">]</code> = tmp3;</a>
            <a href="qr_p.html#qri18" target="origFile">}</a>
        <a href="qr_p.html#qri12" target="origFile">}</a>
        <a href="qr_p.html#qri11" target="origFile">pushinteger4_(adFrom);</a>
    <a href="qr_p.html#qri11" target="origFile">}</a>
    <a href="qr_p.html#qr" target="origFile"><code class="keyword">for </code>(n = na-<code class="constant">1</code>; n >= <code class="constant">0</code>; --n) {</a>
        <a href="qr_p.html#qr" target="origFile">popinteger4_(<code class="keyword">&</code>adFrom);</a>
        <a href="qr_p.html#qr" target="origFile"><code class="keyword">for </code>(m = na-<code class="constant">1</code>; m >= adFrom; --m) {</a>
            <a href="qr_p.html#qr" target="origFile">stb = <code class="constant">0.0</code>;</a>
<a name="qr_bi7"></a>            <a href="qr_p.html#qr" target="origFile">ctb = <code class="constant">0.0</code>;</a>
            <a href="qr_p.html#qr" target="origFile"><code class="keyword">for </code>(k = na-<code class="constant">1</code>; k >= <code class="constant">0</code>; --k) {</a>
                <a href="qr_p.html#qri24" target="origFile">popreal8_(<code class="keyword">&</code>qt<code class="keyword">[</code>res12<code class="keyword">]</code>);</a>
                <a href="qr_p.html#qri24" target="origFile">tmp3b = qtb<code class="keyword">[</code>res12<code class="keyword">]</code>;</a>
<a name="qr_bi8"></a>                <a href="qr_p.html#qri24" target="origFile">qtb<code class="keyword">[</code>res12<code class="keyword">]</code> = <code class="constant">0.0</code>;</a>
                <a href="qr_p.html#qri24" target="origFile">qtb<code class="keyword">[</code>res13<code class="keyword">]</code> = qtb<code class="keyword">[</code>res13<code class="keyword">] </code>+ ct*tmp3b;</a>
                <a href="qr_p.html#qri23" target="origFile">tmp2b = qtb<code class="keyword">[</code>res10<code class="keyword">]</code>;</a>
                <a href="qr_p.html#qri24" target="origFile">ctb = ctb + qtnk*tmp2b + qt<code class="keyword">[</code>res13<code class="keyword">]</code>*tmp3b;</a>
                <a href="qr_p.html#qri24" target="origFile">stb = stb - qtnk*tmp3b;</a>
                <a href="qr_p.html#qri24" target="origFile">qtnkb = ct*tmp2b - st*tmp3b;</a>
<a name="qr_bi9"></a>                <a href="qr_p.html#qri23" target="origFile">popreal8_(<code class="keyword">&</code>qt<code class="keyword">[</code>res10<code class="keyword">]</code>);</a>
<a name="qr_bi10"></a>                <a href="qr_p.html#qri23" target="origFile">qtb<code class="keyword">[</code>res10<code class="keyword">]</code> = <code class="constant">0.0</code>;</a>
                <a href="qr_p.html#qri22" target="origFile">popreal8_(<code class="keyword">&</code>qtnk);</a>
                <a href="qr_p.html#qri21" target="origFile">popreal8_(<code class="keyword">&</code>r<code class="keyword">[</code>res7<code class="keyword">]</code>);</a>
                <a href="qr_p.html#qri21" target="origFile">tmp1b = rb<code class="keyword">[</code>res7<code class="keyword">]</code>;</a>
<a name="qr_bi11"></a>                <a href="qr_p.html#qri21" target="origFile">rb<code class="keyword">[</code>res7<code class="keyword">]</code> = <code class="constant">0.0</code>;</a>
                <a href="qr_p.html#qri21" target="origFile">rb<code class="keyword">[</code>res8<code class="keyword">]</code> = rb<code class="keyword">[</code>res8<code class="keyword">] </code>+ ct*tmp1b;</a>
                <a href="qr_p.html#qri20" target="origFile">tmp0b = rb<code class="keyword">[</code>res5<code class="keyword">]</code>;</a>
                <a href="qr_p.html#qri21" target="origFile">ctb = ctb + rnk*tmp0b + r<code class="keyword">[</code>res8<code class="keyword">]</code>*tmp1b;</a>
                <a href="qr_p.html#qri20" target="origFile">popreal8_(<code class="keyword">&</code>r<code class="keyword">[</code>res5<code class="keyword">]</code>);</a>
                <a href="qr_p.html#qri23" target="origFile">stb = stb + r<code class="keyword">[</code>res6<code class="keyword">]</code>*tmp0b - rnk*tmp1b + qt<code class="keyword">[</code>res11<code class="keyword">]</code>*tmp2b;</a>
                <a href="qr_p.html#qri23" target="origFile">qtb<code class="keyword">[</code>res11<code class="keyword">]</code> = qtb<code class="keyword">[</code>res11<code class="keyword">] </code>+ st*tmp2b;</a>
                <a href="qr_p.html#qri22" target="origFile">qtb<code class="keyword">[</code>res9<code class="keyword">]</code> = qtb<code class="keyword">[</code>res9<code class="keyword">] </code>+ qtnkb;</a>
                <a href="qr_p.html#qri21" target="origFile">rnkb = ct*tmp0b - st*tmp1b;</a>
<a name="qr_bi12"></a>                <a href="qr_p.html#qri20" target="origFile">rb<code class="keyword">[</code>res5<code class="keyword">]</code> = <code class="constant">0.0</code>;</a>
                <a href="qr_p.html#qri20" target="origFile">rb<code class="keyword">[</code>res6<code class="keyword">]</code> = rb<code class="keyword">[</code>res6<code class="keyword">] </code>+ st*tmp0b;</a>
                <a href="qr_p.html#qri19" target="origFile">popreal8_(<code class="keyword">&</code>rnk);</a>
<a name="qr_bi2"></a>                <a href="qr_p.html#qri19" target="origFile">rb<code class="keyword">[</code>res4<code class="keyword">]</code> = rb<code class="keyword">[</code>res4<code class="keyword">] </code>+ rnkb;</a>
            <a href="qr_p.html#qr" target="origFile">}</a>
<a name="qr_bi3"></a>            <a href="qr_p.html#qri17" target="origFile">popreal8_(<code class="keyword">&</code>st);</a>
            <a href="qr_p.html#qri17" target="origFile">rtb = -(at*ctb/(rt*rt)) - bt*stb/(rt*rt);</a>
            <a href="qr_p.html#qri15" target="origFile"><code class="keyword">if </code>(at*at + bt*bt == <code class="constant">0.0</code>)</a>
                <a href="qr_p.html#qri15" target="origFile">tempb = <code class="constant">0.0</code>;</a>
            <a href="qr_p.html#qri15" target="origFile"><code class="keyword">else</code></a>
<a name="qr_bi4"></a>                <a href="qr_p.html#qri15" target="origFile">tempb = rtb/(<code class="constant">2.0</code>*sqrt(at*at+bt*bt));</a>
            <a href="qr_p.html#qri17" target="origFile">btb = <code class="constant">2</code>*bt*tempb + stb/rt;</a>
            <a href="qr_p.html#qri16" target="origFile">popreal8_(<code class="keyword">&</code>ct);</a>
<a name="qr_bi5"></a>            <a href="qr_p.html#qri16" target="origFile">atb = <code class="constant">2</code>*at*tempb + ctb/rt;</a>
            <a href="qr_p.html#qri15" target="origFile">popreal8_(<code class="keyword">&</code>rt);</a>
<a name="qr_bi6"></a>            <a href="qr_p.html#qri14" target="origFile">popreal8_(<code class="keyword">&</code>bt);</a>
            <a href="qr_p.html#qri14" target="origFile">rb<code class="keyword">[</code>res3<code class="keyword">]</code> = rb<code class="keyword">[</code>res3<code class="keyword">] </code>+ btb;</a>
            <a href="qr_p.html#qri13" target="origFile">popreal8_(<code class="keyword">&</code>at);</a>
            <a href="qr_p.html#qri13" target="origFile">rb<code class="keyword">[</code>res2<code class="keyword">]</code> = rb<code class="keyword">[</code>res2<code class="keyword">] </code>+ atb;</a>
        <a href="qr_p.html#qr" target="origFile">}</a>
    <a href="qr_p.html#qr" target="origFile">}</a>
    <a href="qr_p.html#qr" target="origFile"><code class="keyword">*</code>ab = <code class="constant">0.0</code>;</a>
<a name="qr_bi1"></a>    <a href="qr_p.html#qr" target="origFile"><code class="keyword">for </code>(n = na-<code class="constant">1</code>; n >= <code class="constant">0</code>; --n)</a>
        <a href="qr_p.html#qr" target="origFile"><code class="keyword">for </code>(m = na-<code class="constant">1</code>; m >= <code class="constant">0</code>; --m) {</a>
            <a href="qr_p.html#qri10" target="origFile">ab<code class="keyword">[</code>res1<code class="keyword">]</code> = ab<code class="keyword">[</code>res1<code class="keyword">] </code>+ rb<code class="keyword">[</code>res0<code class="keyword">]</code>;</a>
            <a href="qr_p.html#qri10" target="origFile">rb<code class="keyword">[</code>res0<code class="keyword">]</code> = <code class="constant">0.0</code>;</a>
        <a href="qr_p.html#qr" target="origFile">}</a>
<a name="qr_bi0"></a>    <a href="qr_p.html#qr" target="origFile"><code class="keyword">for </code>(n = na-<code class="constant">1</code>; n >= <code class="constant">0</code>; --n)</a>
        <a href="qr_p.html#qr" target="origFile"><code class="keyword">for </code>(m = na-<code class="constant">1</code>; m >= <code class="constant">0</code>; --m)</a>
            <a href="qr_p.html#qri7" target="origFile">qtb<code class="keyword">[</code>res<code class="keyword">]</code> = <code class="constant">0.0</code>;</a>
<a href="qr_p.html#qr" target="origFile">}</a>
</pre>
</body>
